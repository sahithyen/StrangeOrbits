(function(a){if(typeof exports==="object"){module.exports=a()}else{if(typeof define==="function"&&define.amd){define("StrangeOrbits",[],a)}else{window.StrangeOrbits=a()}}})(function(){var a=function(m,l){var d=Math.PI*2;var O=true,p={x:null,y:null,force:1},h=false,J=false,q=[],G=[],E=null,o=null,Q,k={},e,n,g,r,N,y,x,F,v;this.options=v={color:"#FFFFFF",pointDensity:0.0075,minParticleRadius:1,maxParticleRadius:3,minParticleOpacity:0.15,maxParticleOpacity:0.85,minTrembleOffset:10,maxTrembleOffset:20,minTrembleDuration:250,maxTrembleDuration:750,pointForceActivated:true,pointForceRadius:60,clickedMouseForceActivated:true,clickedMouseForceRadius:70,animationEasings:{ease:new BezierEasing(0.25,0.1,0.25,1),linear:new BezierEasing(0,0,1,1),"ease-in":new BezierEasing(0.42,0,1,1),"ease-out":new BezierEasing(0,0,0.58,1),"ease-in-out":new BezierEasing(0.42,0,0.58,1),strange:new BezierEasing(0.7,0,0.3,1)}};v.__defineGetter__("backgroundColor",function(){return m.style.backgroundColor});v.__defineSetter__("backgroundColor",function(R){m.style.backgroundColor=R});var K=function(){g=document.createElement("canvas");m.appendChild(g);r=g.getContext("2d");N=document.createElement("canvas");y=N.getContext("2d");v.backgroundColor="#080808";if(typeof l==="object"){for(var R in l){v[R]=l[R]}}D();window.addEventListener("resize",D);m.addEventListener("mousemove",H);m.addEventListener("mousedown",M);m.addEventListener("mouseup",w);m.addEventListener("touchstart",u);m.addEventListener("touchmove",P);m.addEventListener("touchend",f);m.addEventListener("touchcancel",f);m.addEventListener("webkitmouseforcewillbegin",t);m.addEventListener("webkitmouseforcedown",L);m.addEventListener("webkitmouseforceup",L);m.addEventListener("webkitmouseforcechanged",L)};this.start=function(){O=false;x=Date.now();F=requestAnimationFrame(b)};this.stop=function(){O=true};this.showFigure=function(S,R,U,T){k[S.src]=S;G.push({type:"showFigure",clock:0,ready:false,duration:R,easing:typeof U==="undefined"?"strange":U,callback:T,image:S})};this.hideFigure=function(R,T,S){G.push({type:"hideFigure",clock:0,ready:true,duration:R,easing:typeof T==="undefined"?"strange":T,callback:S})};var D=function(){var R,T,S;e=m.offsetWidth;n=m.offsetHeight;R=window.devicePixelRatio||1;T=r.webkitBackingStorePixelRatio||r.mozBackingStorePixelRatio||r.msBackingStorePixelRatio||r.oBackingStorePixelRatio||r.backingStorePixelRatio||1;S=R/T;g.width=e*S;g.height=n*S;g.style.width=e+"px";g.style.height=n+"px";r.scale(S,S);y.canvas.width=e;y.canvas.height=n;Q={};if(o!==null){c(k[o],function(){j()})}};var H=function(R){J=true;p.x=R.clientX;p.y=R.clientY};var M=function(R){h=true};var w=function(){h=false};var P=function(R){p.x=R.changedTouches[0].clientX;p.y=R.changedTouches[0].clientY};var t=function(R){R.preventDefault()};var L=function(R){p.force=R.webkitForce||1};var u=function(){J=true};var f=function(){J=false};var b=function(){var U,T,W,V,R,S;U=Date.now();T=U-x;x=U;W=z(T);r.clearRect(0,0,e,n);r.fillStyle=v.color;for(V=0;V<q.length;V++){q[V].update(W,T);R=q[V];r.beginPath();r.arc(R.position.x,R.position.y,R.radius,0,d);r.closePath();r.globalAlpha=R.opacity;r.fill()}if(!O){F=requestAnimationFrame(b)}};var z=function(R){var T,V,U,S;if(E===null){if(G.length!==0){E=G[0];G.splice(0,1);switch(E.type){case"showFigure":c(E.image,function(){E.ready=true});break;case"hideFigure":o=null;for(T=0;T<q.length;T++){q[T].setOffset()}break}if(typeof E.easing==="string"){V=E.easing;E.easing=v.animationEasings[V]}}else{return 1}}if(!E.ready){return 1}E.clock+=R;U=E.clock/E.duration;S=E.easing(U);if(U>=1){j();if(typeof E.callback==="function"){E.callback()}E=null}return S};var s=function(T){var S,R;for(S=0;S<T.length;S++){if(typeof q[S]==="undefined"){R=new i(T[S]);q.push(R)}else{q[S].setPosition(T[S])}}for(S=T.length;S<q.length;S++){q[S].setOffset(T[S])}};var j=function(){for(var R=0;R<q.length;R++){if(q[R].offscreen){q.splice(R,1);R--}}};var c=function(T,U){var R,S;o=T;S=new Image();S.onload=function(){if(Array.isArray(Q[o])){R=Q[o]}else{R=Q[o]=I(S)}s(R);U()};S.src=o};var I=function(S){var W,U,V,R,T,X,aa,Z,Y;W=1;W=e/S.width;if(n/S.height<W){W=n/S.height}U={width:W*S.width,height:W*S.height};V={x:e/2-U.width/2,y:n/2-U.height/2};y.clearRect(0,0,e,n);y.drawImage(S,V.x,V.y,U.width,U.height);R=y.getImageData(0,0,e,n).data;T=3;aa=[];for(Y=0;Y<n;Y++){for(Z=0;Z<e;Z++,T+=4){if(R[T]>127&&Math.random()<v.pointDensity){aa.push({x:Z,y:Y})}}}return aa};function i(R){var S,U,T;S=v.maxParticleRadius-v.minParticleRadius;this.radius=Math.random()*S+v.minParticleRadius;U=v.maxParticleOpacity-v.minParticleOpacity;this.opacity=Math.random()*U+v.minParticleOpacity;this.offscreen=false;switch(Math.floor(Math.random()*4)){case 0:this.offscreenPosition={x:Math.random()*(e+200)-100,y:Math.random()*-80-20};break;case 1:this.offscreenPosition={x:e+(Math.random()*80+20),y:Math.random()*(n+200)-100};break;case 2:this.offscreenPosition={x:Math.random()*(e+200)-100,y:n+(Math.random()*80+20)};break;case 3:this.offscreenPosition={x:Math.random()*-80-20,y:Math.random()*(n+200)-100};break}this.position={x:this.offscreenPosition.x,y:this.offscreenPosition.y};this.previousPosition={x:this.offscreenPosition.x,y:this.offscreenPosition.y};this.nextPosition={x:R.x,y:R.y};this.previousTrembleOffset={x:0,y:0};this.nextTrembleOffset={x:0,y:0};this.mouseOffset={x:0,y:0};T=v.maxTrembleDuration-v.minTrembleDuration;this.trembleDuration=Math.random()*T+v.minTrembleDuration;this.trembleClock=v.maxTrembleDuration}i.prototype.setPosition=function(R){this.previousPosition={x:this.nextPosition.x,y:this.nextPosition.y};this.nextPosition={x:R.x,y:R.y}};i.prototype.setOffset=function(){this.previousPosition={x:this.nextPosition.x,y:this.nextPosition.y};this.nextPosition={x:this.offscreenPosition.x,y:this.offscreenPosition.y};this.offscreen=true};i.prototype.update=function(Z,Y){var U,T;if(Z<1){U=this.nextPosition.x-this.previousPosition.x;T=this.nextPosition.y-this.previousPosition.y;this.position={x:this.previousPosition.x+(U*Z),y:this.previousPosition.y+(T*Z)}}else{this.position={x:this.nextPosition.x,y:this.nextPosition.y}}var S,R,ab;if(this.trembleDuration<=this.trembleClock){this.trembleClock=0;this.previousTrembleOffset={x:this.nextTrembleOffset.x,y:this.nextTrembleOffset.y};R=v.maxTrembleOffset-v.minTrembleOffset;this.nextTrembleOffset={x:Math.random()*R-v.minTrembleOffset,y:Math.random()*20-10}}U=this.nextTrembleOffset.x-this.previousTrembleOffset.x;T=this.nextTrembleOffset.y-this.previousTrembleOffset.y;this.trembleClock+=Y;S=this.trembleClock/this.trembleDuration;ab={x:this.previousTrembleOffset.x+(U*S),y:this.previousTrembleOffset.y+(T*S)};this.position={x:this.position.x+ab.x,y:this.position.y+ab.y};if(!v.pointForceActivated){return}var aa,X,W,V;U=this.position.x-p.x;T=this.position.y-p.y;X=Math.sqrt(Math.pow(U,2)+Math.pow(T,2));if(h&&v.clickedMouseForceActivated){aa=v.clickedMouseForceRadius*p.force}else{aa=v.pointForceRadius}W=Math.abs(this.mouseOffset.x)>0||Math.abs(this.mouseOffset.y)>0;if(!J&&W){this.mouseOffset.x-=this.mouseOffset.x*0.1;this.mouseOffset.y-=this.mouseOffset.y*0.1}else{if(Math.abs(X)<aa){V={x:(U/X*aa)-U,y:(T/X*aa)-T};this.mouseOffset.x+=(V.x-this.mouseOffset.x)*0.1;this.mouseOffset.y+=(V.y-this.mouseOffset.y)*0.1}else{if(W){this.mouseOffset.x-=this.mouseOffset.x*0.1;this.mouseOffset.y-=this.mouseOffset.y*0.1}}}this.position={x:this.position.x+this.mouseOffset.x,y:this.position.y+this.mouseOffset.y}};K()};return a});var NEWTON_ITERATIONS=4;var NEWTON_MIN_SLOPE=0.001;var SUBDIVISION_PRECISION=1e-7;var SUBDIVISION_MAX_ITERATIONS=10;var kSplineTableSize=11;var kSampleStepSize=1/(kSplineTableSize-1);var float32ArraySupported=typeof Float32Array==="function";function A(a,b){return 1-3*b+3*a}function B(a,b){return 3*b-6*a}function C(a){return 3*a}function calcBezier(c,a,b){return((A(a,b)*c+B(a,b))*c+C(a))*c}function getSlope(c,a,b){return 3*A(a,b)*c*c+2*B(a,b)*c+C(a)}function binarySubdivide(e,f,d,h,g){var a,c,b=0;do{c=f+(d-f)/2;a=calcBezier(c,h,g)-e;if(a>0){d=c}else{f=c}}while(Math.abs(a)>SUBDIVISION_PRECISION&&++b<SUBDIVISION_MAX_ITERATIONS);return c}function newtonRaphsonIterate(d,b,g,e){for(var c=0;c<NEWTON_ITERATIONS;++c){var f=getSlope(b,g,e);if(f===0){return b}var a=calcBezier(b,g,e)-d;b-=a/f}return b}window.BezierEasing=function bezier(f,b,e,h){if(!(0<=f&&f<=1&&0<=e&&e<=1)){throw new Error("bezier x values must be in [0, 1] range")}var g=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize);if(f!==b||e!==h){for(var d=0;d<kSplineTableSize;++d){g[d]=calcBezier(d*kSampleStepSize,f,e)}}function a(m){var n=0;var l=1;var i=kSplineTableSize-1;for(;l!==i&&g[l]<=m;++l){n+=kSampleStepSize}--l;var o=(m-g[l])/(g[l+1]-g[l]);var k=n+o*kSampleStepSize;var j=getSlope(k,f,e);if(j>=NEWTON_MIN_SLOPE){return newtonRaphsonIterate(m,k,f,e)}else{if(j===0){return k}else{return binarySubdivide(m,n,n+kSampleStepSize,f,e)}}}return function c(i){if(f===b&&e===h){return i}if(i===0){return 0}if(i===1){return 1}return calcBezier(a(i),b,h)}};